# 📁 文件批量重命名工具

<div align="center">

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![PyQt6](https://img.shields.io/badge/PyQt6-6.0+-green.svg)
![License](https://img.shields.io/badge/License-MIT-yellow.svg)

一个文件批量重命名工具，智能识别学号、姓名和项目名，一键规范化文件命名。

[功能特点](#-功能特点) • [快速开始](#-快速开始) • [使用教程](#-使用教程) • [部署说明](#-部署说明)

</div>

---

## 📖 开发背景

作为班级学委，虽然学校有统一收集作业的小程序，但仍有很多同学选择直接发给学委来统一上交。尽管反复强调了文件命名格式，但收到的作业文件名依然五花八门：

```
❌ 作业1.docx
❌ 张三-会计作业.pdf
❌ 会计作业-副本-李四-12345678.docx
❌ Accounting Assignment - Wang Wu.docx
❌ 项目管理-样本-赵六.xlsx
```

为了节省文件命名时间，开发了这个工具，能够**自动识别**文件名中的学号、姓名和项目名，并**统一重命名**为规范格式：

```
✅ 12345678-张三-会计作业.docx
✅ 12345678-李四-会计作业.pdf
✅ Wang Wu-会计作业.docx
✅ 12345678-赵六-项目管理.xlsx
```

---

## ✨ 功能特点

### 🎯 智能识别
- **自动检测学号**：支持 4-15 位数字学号，自动识别最常见的长度
- **智能提取姓名**：支持中文姓名（2-4 字）和英文姓名（First Last）
- **项目名自动填充**：扫描所有文件，自动识别最常见的项目名

### 🔧 强大的忽略词功能
```
因为该工具是利用正则表达式来识别，没有接入Ai工具（只基于本地）。存在一些识别上的局限，加入忽略词功能可以大大提高识别的准确性。
```
这是本工具的**核心特色**，用于排除文件名中的干扰词：

- **自动推荐**：扫描后自动推荐 4 个常见的中文干扰词
- **手动输入**：支持空格或逗号分隔，输入任意需要忽略的词
- **双击添加**：在预览表格中双击 Name 列的词，即可快速添加
- **智能匹配**：
  - 支持单字和多字部分匹配
  - 例如输入"练习"，会从"练习一"中移除"练习"，只保留"一"
  - 中文和英文都支持

### 🎨 灵活的命名选项
- **多种命名模式**：学号-姓名-项目名 / 姓名-学号-项目名 / 项目名-学号-姓名 等
- **分隔符选择**：横杆 `-`、下划线 `_`、空格或无分隔符
- **自定义文本**：可添加班级名、课程代码等自定义内容

### 💡 其他特性
- **可编辑预览**：所有字段都可以手动修改
- **撤回功能**：重命名后可以一键撤回到原始文件名
- **批量处理**：一次处理整个文件夹的所有文件

<p align="center">
  <img src="https://yehongliang.com/github/rename/11.png" alt="预览" width="500">
</p>
---


## 🤝 拓展使用

学号可以改成手机号，项目名可以改成文件名或者公司名等，用来处理收集到的简历，报名资料等。

---

## 🚀 快速开始

### 方式一：直接运行（推荐）

1. **克隆项目**
```bash
git clone https://github.com/Chestnutye/FileRenamer.git
cd FileRenamer
```

2. **安装依赖**
```bash
pip install -r requirements.txt
```

3. **运行程序**
```bash
python main.py
```

### 方式二：使用可执行文件

~~下载 [Releases](https://github.com/) 中的可执行文件，双击运行即可。~~
- [ ] Win 版本打包
- [ ] Mac 版本打包

---

## 📚 使用教程

### 第一步：选择文件夹

点击 **"选择文件夹"** 按钮，选择包含学生作业文件的文件夹。

程序会自动：
- 📊 扫描所有文件
- 🔍 检测学号长度
- 🎯 识别最常见的项目名并自动填充
- 💡 生成推荐的忽略词

<p align="center">
  <img src="https://yehongliang.com/github/rename/10.png" alt="选择文件夹" width="600">
</p>

---

### 第二步：配置忽略词（重要！）

这是**提高识别准确率的关键步骤**！

#### 方法 1：使用推荐词按钮 ⭐
- 查看 "推荐" 下方的按钮
- 点击不想要的词（如"样本"、"副本"、"练习"）
- 它们会自动添加到忽略词输入框

<p align="center">
  <img src="https://yehongliang.com/github/rename/20.png" alt="推荐词" width="500">
</p>

#### 方法 2：手动输入
在 "忽略词" 输入框中输入需要忽略的词：
```
样本 副本 练习 大综合
```
> 💡 多个词用空格或逗号分隔

#### 方法 3：双击添加
- 查看预览表格中的 "姓名" 列
- 发现不想要的词（如"样本"被识别为姓名）
- **双击那个词**，它会自动添加到忽略词

<p align="center">
  <img src="https://yehongliang.com/github/rename/30.png" alt="双击添加" width="600">
</p>

---

### 第三步：调整设置（可选）

根据需要调整以下设置：

| 设置项 | 说明 | 示例 |
|--------|------|------|
| **学号长度** | 如果自动检测不准确，可手动修改 | `8-12` 或 `9` |
| **标准项目名** | 可以手动修改项目名 | `会计作业`、`项目管理` |
| **自定义文本** | 添加班级名、课程代码等 | `一班`、`ACC101` |
| **命名模式** | 选择喜欢的命名格式 | `学号-姓名-项目名` |
| **分隔符** | 选择分隔符 | `-`、`_`、空格 |

---

### 第四步：预览和调整

点击 **"刷新预览"** 查看预览结果。

在预览表格中：
- ✏️ **学号列可以直接编辑**（双击单元格）
- 👆 **姓名列可以双击添加到忽略词**
- 👀 **新文件名列显示重命名后的文件名**

如果发现问题：
1. 调整忽略词
2. 点击 "刷新预览" 重新生成
3. 重复直到满意

<p align="center">
  <img src="https://yehongliang.com/github/rename/40.png" alt="预览" width="600">
</p>

---

### 第五步：执行重命名

确认无误后，点击 **"执行重命名"** 按钮。

> ⚠️ **重要提示**：
> - 重命名操作会立即执行
> - 建议先在测试文件夹中试用
> - 如果出错，可以点击 **"撤回重命名"** 按钮恢复

---

## 💡 使用技巧

### 1️⃣ 优先配置忽略词
先排除干扰词，再查看预览。这是提高准确率的关键！

### 2️⃣ 善用推荐词按钮
程序会自动推荐常见的干扰词，点击即可添加，非常方便。

### 3️⃣ 双击快速添加
发现姓名列有错误识别的词，直接双击添加到忽略词。

### 4️⃣ 检查 NoID 文件
没有学号的文件需要特别注意，可能需要手动补充学号。

### 5️⃣ 分批处理
如果文件来自不同课程，建议分文件夹分批处理。

---

## 📋 使用示例

### 场景 1：会计作业

**原始文件名：**
```
练习-Stage3-张三.docx
会计作业-样本-李四-12345678.pdf
Accounting-副本-王五.xlsx
```

**操作步骤：**
1. 选择文件夹
2. 忽略词输入：`练习 样本 副本`
3. 标准项目名自动填充为：`会计作业`

**重命名结果：**
```
12345678-张三-会计作业.docx
12345678-李四-会计作业.pdf
NoID-王五-会计作业.xlsx
```

---

## 🛠️ 部署说明

### 环境要求

- Python 3.8 或更高版本
- PyQt6

### 安装步骤

1. **克隆仓库**
```bash
git clone https://github.com/Chestnutye/FileRenamer.git
cd FileRenamer
```

2. **创建虚拟环境（推荐但可选）**
```bash
python3 -m venv venv
source venv/bin/activate  # macOS/Linux
# 或
venv\Scripts\activate  # Windows
```

3. **安装依赖**
```bash
pip install -r requirements.txt
```

4. **运行程序**
```bash
python main.py
```

---

### 打包为可执行文件

使用 PyInstaller 打包为独立应用：

```bash
# 安装 PyInstaller
pip install pyinstaller

# 打包（macOS/Linux）
pyinstaller --name="FileRenamer" --windowed --onefile main.py

# 打包（Windows）
pyinstaller --name="FileRenamer" --windowed --onefile --icon=icon.ico main.py
```

打包后的可执行文件位于 `dist/` 目录。

---

## 🏗️ 项目结构

```
file-renamer/
├── README.md           # 项目说明文档
├── main.py             # 程序入口
├── requirements.txt    # Python 依赖
├── build.sh            # 打包脚本
├── core/               # 核心逻辑
│   ├── __init__.py
│   ├── parser.py       # 文件名解析
│   ├── renamer.py      # 批量重命名
│   └── scanner.py      # 文件扫描
└── ui/                 # 用户界面
    ├── __init__.py
    └── app.py          # PyQt6 GUI
```

---

## ⚠️ 注意事项

- ⚡ 重命名操作不可撤销（除非使用撤回功能），建议先在测试文件夹中试用
- 📝 如果文件名中没有学号，会显示为 NoID（但在最终文件名中会被隐藏）
- 🔤 中文姓名识别基于常见模式（2-4 个汉字），特殊情况可能需要手动调整
- 💾 建议在重命名前备份原始文件

---

## 📄 许可证

MIT License

---

<div align="center">

**感谢任劳任怨的Ai帮我优化逻辑** 

</div>